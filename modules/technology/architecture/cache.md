# 缓存问题

## 缓存雪崩

### 现象

指缓存中的数据大批量到过期时间，而查询量巨大，引起数据库压力过大或宕机。

### 解决方案

1. 缓存数据的过期时间要加上随机值，防止同一时间大量数据过期现象发生。
2. 如果缓存是分布式部署。将热点数据均匀分布在不同的缓存数据库中。
3. 设置热点数据永不过期。

## 缓存穿透

### 现象

缓存穿透是指缓存和数据库中都没有的数据，而用户不断发起请求，如发起为id为“-1”的数据或id为特别大不存在的数据。这时的用户很可能是攻击者，攻击会导致数据库压力过大。

### 答案

1. 如果可以将ID指定在有效范围内的才能访问数据库。
2. 布隆过滤器，一个byte数组，根据数据量多少决定大小。

## 缓存击穿

缓存击穿是指缓存中没有但数据库中有的数据（一般是缓存时间到期），这时由于并发用户特别多，同时读缓存没读到数据，又同时去数据库去取数据，引起数据库压力瞬间增大，造成过大压力